]Sub Homework_Moderate()numofRows = Cells(Rows.Count, "A").End(xlUp).RowDim Total_volume As DoubleDim open_price_row As LongLongTotal_volume = Cells(2, 7).ValueDisplay_row = 2open_price_row = 2Cells(1, 9).Value = "Ticker"Cells(1, 10).Value = "Yearly Change"Cells(1, 11).Value = "Percent Change"Cells(1, 12).Value = "Total Volume"For i = 2 To numofRows'If the next cell value equals to the current cell value,'Then add the next cell volume number to the current total volme numberIf Cells(i + 1, 1).Value = Cells(i, 1).Value ThenTotal_volume = Total_volume + Cells(i + 1, 7).Value'if the next cell value does not equal to the current cell value,'Then return the total volume number to cell(2,10) and current cells ticker symbol to cells(2,9)ElseIf Cells(i + 1, 1).Value <> Cells(i, 1).Value ThenCells(Display_row, 12).Value = Total_volumeCells(Display_row, 9).Value = Cells(i, 1).ValueCells(Display_row, 10).Value = Cells(i, 6).Value - Cells(open_price_row, 3).Value If Cells(open_price_row, 3).Value = 0 Then Cells(Display_row, 11).Value = 0 Else    Cells(Display_row, 11).Value = (Cells(i, 6).Value - Cells(open_price_row, 3).Value) / Cells(open_price_row, 3).Value    open_price_row = i + 1  End If    Display_row = Display_row + 1  Total_volume = Cells(i + 1, 7).ValueEnd If'Reset Total volume number and adjust Display_row and Open_price_row numberNext iEnd Sub


